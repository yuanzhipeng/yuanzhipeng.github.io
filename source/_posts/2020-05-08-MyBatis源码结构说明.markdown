---
layout: post
Title: "MyBatis源码结构说明"
Date: 2020-06-09 22:56:34.00000000 + 09:00
---

# MyBatis源码结构说明

## 阅读MyBatis源码时可以借助本文档快速查阅相应的包 

* org.apache.ibatis.annotations
  * 包含所有mapper接口中用到的注解。例如常用的@Param、@Update、@Select、@Delete
* org.apache.ibatis.binding
  * 生成mapper接口的动态代理并进行管理

* org.apache.ibatis.builder
  * 包含Configuration对象所有构建器，主要包括XML、注解2中方式配置解析
  * BaseBuilder构建器基类
  * XMLConfigBuilder解析Configuration.xml配置文件
  * XMLMapperBuilder解析Mapper.xml配置文件
  * XMLStatementBuilder解析select、update、delete标签
  * MapperAnnotationBuilder注解式Mapper
* org.apache.ibatis.cache
  * 缓存功能实现、包涵各种缓存装饰器
  * TransactionalCache二级缓存功能实现
* org.apache.ibatis.cursor
  * 实现游标的方式查询数据、游标非常适合处理百万级别的数据查询，通常情况下不适合一次性加载到内存中，这种方式类似使用SAX解析XML文件
* org.apache.ibatis.datasource
  * 数据源包括jndi数据源、连接池功能
* org.apache.ibatis.executor
  * 包含SQL语句执行器，核心功能包
  * ErrorContext错误上下文对象，跟踪所有执行流程
  * 主要功能包括
    * 主键生成功能
    * 执行餐睡解析功能
    * 执行结果集解析功能
    * SQL执行器
    * 缓存执行器
* org.apache.ibatis.exceptions
  * 框架异常，常见异常：TooManyResultsException
* org.apache.ibatis.io
  * 资源文件读取
* org.apache.ibatis.jdbc
  * JDBC一些操作
  * SqlRunner SQL执行
  * ScriptRunner简本执行，可以执行建库语句，在执行测试用例时候用的非常多
* org.apache.ibatis.lang
  * 这个包直邮两个注解@UsesJava7、@UsesJava8使用这两个注解标识哪些可以使用JDK7 API，哪些可以使用JDK8 API
* org.apache.ibatis.logging
  * 日志功能，实现多种日志框架的对接
  * org.apache.ibatis.logging.jdbc代理所有功能JDBC操作，实现了在debug模式下能够输出SQL
* org.apache.ibatis.mapping
  * 配置文件与实体对象的映射功能，Mapper映射、参数映射、结果映射等
* org.apache.ibatis.parsing
  * 解析工具包
  * GenericTokenParser：解析#{}、${}这种占位符
  * XPathParser：XPath形式解析XML
  * PropertyParser：properties解析器
  * org.apache.ibatis.plugin
* org.apache.ibatis.plugin
  * 拦截器功能实现，使用代理模式实现拦截
* org.apache.ibatis.reflection
  * 反射器功能，这个包下实现元数据编程
  * 通过把JAVA对象转换成元数据对象MetaObject，然后就可以把对元数据进行赋值操作，数据库查询结果到Java对象映射就是用过元对象实现
* org.apache.ibatis.scription
  * 动态SQL语言实现，配置文件中<if>、<weher>、<set>、<foreach>、<choose>功能就是在这个包实现，借助OGNL表达式，你也可以拓展自己的语言实现功能
* org.apache.ibatis.session
  * 主要实现SqlSession功能，非常核心包
  * 官方注释：SqlSession包涵了MyBatis工作的所有的Java接口，通过这些接口你可以执行SQL命令(select\insert\update\delete)，获取Mapper，管理事务
* org.apache.ibatis.transaction
  * 事务功能实现，包装了数据库链接，处理数据库连接
  * 生命周期包括：连接创建，预编译，提交、回滚和关闭
* org.apache.ibatis.type
  * 类型处理器，包括所有数据库类型对应Java类型的处理器，如果要实现自己类型处理器就需要实现包下的基础接口